#!/usr/bin/env bash
# By Anonymousx97


# Colors quoted with $ to work with EOF
magenta=$'\033[1;35m'
green=$'\033[1;32m'
white=$'\033[1;37m'
blue=$'\033[1;34m'
red=$'\033[1;31m'
black=$'\033[1;40;30m'
yellow=$'\033[1;33m'
cyan=$'\033[1;36m'
reset=$'\033[0m'
bgyellow=$'\033[1;43;33m'
bgwhite=$'\033[1;47;37m'

# Termux
if [[ $HOME == "/data/data/com.termux/files/home" ]]; then

  distro_string=" Android ðŸ§¡ Termux"

  function getCodeName(){
    echo "$(getprop ro.product.board)${red}@${reset}$(getprop ro.com.google.clientidbase)"
  }

  function getModel() {
    echo "${magenta}phone${reset}  $(getprop ro.product.vendor.model)"
  }

  function getDistro() {
    echo "${green}os${reset}     $(uname -o) $(uname -m)"
  }

else
  # Desktop

  distro_string=" Linux ðŸ§¡ Desktop "

  function getCodeName(){
    echo "$(grep -oP '^[Model|Hardware].*: \K.*' /proc/cpuinfo)"
  }

  function getModel() {
    echo "${magenta}host${reset}   $(hostname)"
  }

  function getDistro() {
    echo "${green}os${reset}     $(grep -oP '^NAME="\K[^"]+' /etc/os-release)"
  }

fi

function getKernel() {
  echo "${cyan}ker${reset}    $(uname -r)"
}

function getTotalPackages() {
  echo "${blue}pkgs${reset}   $(apt list --installed 2>/dev/null | wc -l)"
}

function getShell() {
  local shell="$(basename $SHELL)"

  if [[ $shell=="login" ]]; then
    local custom_shell="/data/data/com.termux/files/home/.termux/shell"

    if [[ -f $custom_shell && -x $custom_shell ]]; then
      shell="$($custom_shell -c 'basename "$0"')"
    else
      shell="bash"
    fi

  fi

  echo "${red}sh${reset}     $shell"
}

function getUptime() {
  echo "${yellow}up${reset}    $(uptime --pretty | sed 's/up//')"
}

function getMemoryUsage() {
  read -r used total <<< "$(free --mega | awk '/Mem:/ {print $3, $2}')"
  echo "${magenta}ram${reset}    ${used}MB ${red}/${reset} ${total}MB"
}

function getDiskUsage() {
  read -r size used available percent <<< "$(df -h . | awk 'NR==2 {print $2, $3, $4, $5}')"
  local mem_color
  awk '{if ($1+0 < 10) exit 0; else exit 1}' <<< "$available" && mem_color=$red || mem_color=$green
  echo "${green}disk${reset}   ${used}B ${red}/${reset} ${size}B = ${mem_color}${available}B${reset} (${percent})"
}

cat << EOF


  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
  â”ƒ  ${magenta}r${green}x${cyan}f${blue}e${red}t${yellow}${cyan}c${magenta}h${reset}     ${red}ï—${reset}  ${yellow}ï–${reset}  ${cyan}ï„¹${reset}  â”ƒ  $(getCodeName)
  â”£â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”«
  â”ƒ                       â”ƒ  $(getModel)
  â”ƒ          ${white}â€¢${black}_${white}â€¢${reset}          â”ƒ  $(getDistro)
  â”ƒ          ${black}${reset}${bgyellow}oo${reset}${black}|${reset}          â”ƒ  $(getKernel)
  â”ƒ         ${black}/${reset}${bgwhite}â€‚${reset}${black}'\'${reset}         â”ƒ  $(getTotalPackages)
  â”ƒ        ${bgyellow}(${reset}${black}\_;/${reset}${bgyellow})${reset}         â”ƒ  $(getShell)
  â”ƒ                       â”ƒ  $(getUptime)
  â”ƒ  ${distro_string}   â”ƒ  $(getMemoryUsage)
  â”ƒ                       â”ƒ  $(getDiskUsage)
  â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›  ${magenta}â”â”â”${green}â”â”â”${white}â”â”â”${blue}â”â”â”${red}â”â”â”${yellow}â”â”â”${cyan}â”â”â”${reset}


EOF

